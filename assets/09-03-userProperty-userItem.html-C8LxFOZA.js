import{_ as a,c as t,e as o,a as r,b as e,d as p,w as i,r as c,o as l}from"./app-CdUme-sL.js";const u={};function d(m,s){const n=c("RouteLink");return l(),t("div",null,[s[3]||(s[3]=o(`<h1 id="userproperty-and-useritem" tabindex="-1"><a class="header-anchor" href="#userproperty-and-useritem"><span>userProperty and userItem</span></a></h1><p>From <strong>user service</strong> (<code>use: [ userService ]</code>). A <strong>processor</strong> in user-service scans your models for <strong>userProperty</strong> or <strong>userItem</strong> and turns them into <strong>propertyOf User</strong> or <strong>itemOf User</strong>, then adds views and actions (myUserXxx, setMyUserXxx, createMyUserXxx, etc.). Use when the owner is always a <strong>User</strong> (logged-in).</p><h2 id="userproperty" tabindex="-1"><a class="header-anchor" href="#userproperty"><span>userProperty</span></a></h2><p>One record per user. The processor sets <code>model.propertyOf = { what: User, ...config }</code> and adds:</p><ul><li>View <strong>myUser&lt;ModelName&gt;</strong> — Read the property for <code>client.user</code>.</li><li>Actions <strong>setMyUser&lt;ModelName&gt;</strong> (Set), <strong>updateMyUser&lt;ModelName&gt;</strong> (Update), <strong>resetMyUser&lt;ModelName&gt;</strong> (Reset) when the corresponding access is set.</li></ul><h3 id="configuration-on-the-model" tabindex="-1"><a class="header-anchor" href="#configuration-on-the-model"><span>Configuration (on the model)</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">model<span class="token punctuation">.</span>userProperty <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  userReadAccess<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">params<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> boolean<span class="token punctuation">,</span></span>
<span class="line">  userSetAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  userUpdateAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  userResetAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  userWriteAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span>  <span class="token comment">// enables set/update/reset if not specified</span></span>
<span class="line">  writableProperties<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  userViews<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> name<span class="token operator">?</span><span class="token punctuation">,</span> prefix<span class="token operator">?</span><span class="token punctuation">,</span> suffix<span class="token operator">?</span><span class="token punctuation">,</span> access<span class="token operator">?</span><span class="token punctuation">,</span> fields<span class="token operator">?</span> <span class="token punctuation">}</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Access can be a function or roles; the generated view uses <strong>userReadAccess</strong> and the generated actions use the set/update/reset access.</p><h2 id="useritem" tabindex="-1"><a class="header-anchor" href="#useritem"><span>userItem</span></a></h2><p>Many records per user. The processor sets <code>model.itemOf = { what: User, ...config }</code> and adds:</p><ul><li>View <strong>myUser&lt;ModelName&gt;s</strong> (plural) — Range of items for <code>client.user</code>.</li><li>Views <strong>myUser&lt;ModelName&gt;sBy&lt;SortField&gt;</strong> if <strong>sortBy</strong> is set.</li><li>View <strong>myUser&lt;ModelName&gt;</strong> — Single item by id (with ownership check).</li><li>Actions <strong>createMyUser&lt;ModelName&gt;</strong> (Create), <strong>updateMyUser&lt;ModelName&gt;</strong> (Update), <strong>deleteMyUser&lt;ModelName&gt;</strong> (Delete) when the corresponding access is set.</li></ul><h3 id="configuration-on-the-model-1" tabindex="-1"><a class="header-anchor" href="#configuration-on-the-model-1"><span>Configuration (on the model)</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">model<span class="token punctuation">.</span>userItem <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  userReadAccess<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">params<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> boolean<span class="token punctuation">,</span></span>
<span class="line">  userCreateAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  userUpdateAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  userDeleteAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  userWriteAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  writableProperties<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  sortBy<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span>   <span class="token comment">// e.g. [&#39;createdAt&#39;] → myUserThingsByCreatedAt</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="when-to-use" tabindex="-1"><a class="header-anchor" href="#when-to-use"><span>When to use</span></a></h2><ul><li><strong>userProperty</strong> — Single settings/preferences object per user (e.g. Billing as user property in billing-service is a different pattern: there it’s “userProperty” in the sense of “one Billing per user” from the app’s perspective; the actual Billing model may be defined with userProperty in a service that uses user-service).</li><li><strong>userItem</strong> — List of things owned by the user (todos, orders, etc.).</li></ul>`,15)),r("p",null,[s[1]||(s[1]=e("For “owner can be either session or user” (e.g. before login), use ")),p(n,{to:"/server/09-04-sessionOrUserProperty-sessionOrUserItem.html"},{default:i(()=>s[0]||(s[0]=[e("sessionOrUserProperty / sessionOrUserItem")])),_:1,__:[0]}),s[2]||(s[2]=e(" instead."))])])}const h=a(u,[["render",d]]),k=JSON.parse('{"path":"/server/09-03-userProperty-userItem.html","title":"userProperty and userItem","lang":"en-US","frontmatter":{"title":"userProperty and userItem"},"headers":[{"level":2,"title":"userProperty","slug":"userproperty","link":"#userproperty","children":[{"level":3,"title":"Configuration (on the model)","slug":"configuration-on-the-model","link":"#configuration-on-the-model","children":[]}]},{"level":2,"title":"userItem","slug":"useritem","link":"#useritem","children":[{"level":3,"title":"Configuration (on the model)","slug":"configuration-on-the-model-1","link":"#configuration-on-the-model-1","children":[]}]},{"level":2,"title":"When to use","slug":"when-to-use","link":"#when-to-use","children":[]}],"git":{"updatedTime":1771163669000,"contributors":[{"name":"Michał Łaszczewski","username":"","email":"michal@laszczewski.com","commits":1}],"changelog":[{"hash":"cfc969ff1ce8a43846182cb1c9818f3c88cd885a","time":1771163669000,"email":"michal@laszczewski.com","author":"Michał Łaszczewski","message":"docs"}]},"filePathRelative":"server/09-03-userProperty-userItem.md"}');export{h as comp,k as data};
