import{_ as n,c as a,e as p,o as e}from"./app-CdUme-sL.js";const t={};function o(c,s){return e(),a("div",null,s[0]||(s[0]=[p(`<h1 id="propertyof-and-itemof" tabindex="-1"><a class="header-anchor" href="#propertyof-and-itemof"><span>propertyOf and itemOf</span></a></h1><p>From <strong>relations plugin</strong> (<code>use: [ relationsPlugin ]</code>). Parent is a <strong>single model</strong> in the same or another service.</p><ul><li><strong>propertyOf</strong> — One child record per parent (e.g. one Settings per Session, one Balance per owner). Adds a single identifier (e.g. billing, session) and Set/Update/Reset events and actions.</li><li><strong>itemOf</strong> — Many child records per parent (e.g. many TopUp per Billing, many Operation per Balance). Adds parent identifier and Created/Updated/Deleted events and actions, plus range views.</li></ul><h2 id="propertyof-—-configuration" tabindex="-1"><a class="header-anchor" href="#propertyof-—-configuration"><span>propertyOf — configuration</span></a></h2><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">model<span class="token punctuation">.</span>propertyOf <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">what</span><span class="token operator">:</span> ParentModel<span class="token punctuation">,</span>   <span class="token comment">// the parent model (e.g. Session, Billing)</span></span>
<span class="line">  readAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  writeAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  listAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  setAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  updateAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  setOrUpdateAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  resetAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  readAllAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  singleAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  singleAccessControl<span class="token operator">?</span><span class="token operator">:</span> AccessControlSettings<span class="token punctuation">,</span></span>
<span class="line">  readAccessControl<span class="token operator">?</span><span class="token operator">:</span> AccessControlSettings<span class="token punctuation">,</span></span>
<span class="line">  writeAccessControl<span class="token operator">?</span><span class="token operator">:</span> AccessControlSettings<span class="token punctuation">,</span></span>
<span class="line">  listAccessControl<span class="token operator">?</span><span class="token operator">:</span> AccessControlSettings<span class="token punctuation">,</span></span>
<span class="line">  setAccessControl<span class="token operator">?</span><span class="token operator">:</span> AccessControlSettings<span class="token punctuation">,</span></span>
<span class="line">  updateAccessControl<span class="token operator">?</span><span class="token operator">:</span> AccessControlSettings<span class="token punctuation">,</span></span>
<span class="line">  resetAccessControl<span class="token operator">?</span><span class="token operator">:</span> AccessControlSettings<span class="token punctuation">,</span></span>
<span class="line">  setOrUpdateAccessControl<span class="token operator">?</span><span class="token operator">:</span> AccessControlSettings<span class="token punctuation">,</span></span>
<span class="line">  views<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;range&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;object&#39;</span><span class="token punctuation">,</span> internal<span class="token operator">?</span><span class="token operator">:</span> boolean<span class="token punctuation">,</span> readAccess<span class="token operator">?</span><span class="token punctuation">,</span> readAccessControl<span class="token operator">?</span><span class="token punctuation">,</span> fields<span class="token operator">?</span> <span class="token punctuation">}</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="itemof-—-configuration" tabindex="-1"><a class="header-anchor" href="#itemof-—-configuration"><span>itemOf — configuration</span></a></h2><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">model<span class="token punctuation">.</span>itemOf <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">what</span><span class="token operator">:</span> ParentModel<span class="token punctuation">,</span></span>
<span class="line">  readAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  writeAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  createAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  updateAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  deleteAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  copyAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  readAllAccess<span class="token operator">?</span><span class="token operator">:</span> AccessSpecification<span class="token punctuation">,</span></span>
<span class="line">  readAccessControl<span class="token operator">?</span><span class="token operator">:</span> AccessControlSettings<span class="token punctuation">,</span></span>
<span class="line">  writeAccessControl<span class="token operator">?</span><span class="token operator">:</span> AccessControlSettings<span class="token punctuation">,</span></span>
<span class="line">  createAccessControl<span class="token operator">?</span><span class="token operator">:</span> AccessControlSettings<span class="token punctuation">,</span></span>
<span class="line">  updateAccessControl<span class="token operator">?</span><span class="token operator">:</span> AccessControlSettings<span class="token punctuation">,</span></span>
<span class="line">  deleteAccessControl<span class="token operator">?</span><span class="token operator">:</span> AccessControlSettings<span class="token punctuation">,</span></span>
<span class="line">  copyAccessControl<span class="token operator">?</span><span class="token operator">:</span> AccessControlSettings<span class="token punctuation">,</span></span>
<span class="line">  readAllAccessControl<span class="token operator">?</span><span class="token operator">:</span> AccessControlSettings</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="example-itemof-topup-per-billing" tabindex="-1"><a class="header-anchor" href="#example-itemof-topup-per-billing"><span>Example: itemOf (TopUp per Billing)</span></a></h2><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// Source: live-change-stack/services/billing-service/topUp.js</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> TopUp <span class="token operator">=</span> definition<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;TopUp&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">itemOf</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">what</span><span class="token operator">:</span> Billing<span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">readAccessControl</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">roles</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;owner&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;admin&#39;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">properties</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> Number <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">price</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> Number <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">currency</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;created&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;paid&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;failed&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;refunded&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">&#39;created&#39;</span> <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="example-itemof-operation-per-balance" tabindex="-1"><a class="header-anchor" href="#example-itemof-operation-per-balance"><span>Example: itemOf (Operation per Balance)</span></a></h2><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// Source: live-change-stack/services/balance-service/operation.js</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> Operation <span class="token operator">=</span> definition<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Operation&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">itemOf</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">what</span><span class="token operator">:</span> Balance<span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">readAccessControl</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">roles</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;owner&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;admin&#39;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">properties</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;started&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;finished&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;canceled&#39;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">causeType</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">validation</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;nonEmpty&#39;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">cause</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token literal-property property">validation</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;nonEmpty&#39;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">change</span><span class="token operator">:</span> config<span class="token punctuation">.</span>currencyType<span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">amountBefore</span><span class="token operator">:</span> config<span class="token punctuation">.</span>currencyType<span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">amountAfter</span><span class="token operator">:</span> config<span class="token punctuation">.</span>currencyType<span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">updatedAt</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="propertyof-in-session-service" tabindex="-1"><a class="header-anchor" href="#propertyof-in-session-service"><span>propertyOf in session-service</span></a></h2><p>Session-service uses a <strong>processor</strong> that turns <strong>sessionProperty</strong> into <strong>propertyOf</strong> with <code>what: Session</code> and adds views/actions (mySessionXxx, setMySessionXxx, etc.). So “session property” is implemented as propertyOf Session.</p>`,13)]))}const i=n(t,[["render",o]]),r=JSON.parse('{"path":"/server/09-01-propertyOf-itemOf.html","title":"propertyOf and itemOf","lang":"en-US","frontmatter":{"title":"propertyOf and itemOf"},"headers":[{"level":2,"title":"propertyOf — configuration","slug":"propertyof-—-configuration","link":"#propertyof-—-configuration","children":[]},{"level":2,"title":"itemOf — configuration","slug":"itemof-—-configuration","link":"#itemof-—-configuration","children":[]},{"level":2,"title":"Example: itemOf (TopUp per Billing)","slug":"example-itemof-topup-per-billing","link":"#example-itemof-topup-per-billing","children":[]},{"level":2,"title":"Example: itemOf (Operation per Balance)","slug":"example-itemof-operation-per-balance","link":"#example-itemof-operation-per-balance","children":[]},{"level":2,"title":"propertyOf in session-service","slug":"propertyof-in-session-service","link":"#propertyof-in-session-service","children":[]}],"git":{"updatedTime":1771163669000,"contributors":[{"name":"Michał Łaszczewski","username":"","email":"michal@laszczewski.com","commits":1}],"changelog":[{"hash":"cfc969ff1ce8a43846182cb1c9818f3c88cd885a","time":1771163669000,"email":"michal@laszczewski.com","author":"Michał Łaszczewski","message":"docs"}]},"filePathRelative":"server/09-01-propertyOf-itemOf.md"}');export{i as comp,r as data};
